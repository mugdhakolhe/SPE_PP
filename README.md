# SPE_PP

Topic : An efficient and secure searchable public key encryption scheme with privacy protection for cloud storage
Functions :
1. **Setup** - It takes as input the security parameter λ and generates the public parameters Para.
2. **KeyGen** - It takes as input the public parameters Para and generates the two public/secret key pairs (P Ku,sku), (P Ks,sks) for DU and DS, respectively
3. **SPE_PP** -  It takes as input the public parameters Para, the DU’s public key P Ku, the DS’s secret key sks and the keyword set W, and generates theciphertext dataset C of W.
4. **Trapdoor** -  It takes as input the public parameters Para, the DU’s public key P Ku, the DS’s secret key sks and the keyword set W, and generates the ciphertext dataset C of W.
5. **Test** - : It takes as input the public parameter Para, the trapdoor Twj of wj and the keyword ciphertext set C, and outputs 1 if the ciphertext Cwi and Twj contain the same keyword and otherwise outputs 0.
            
            For test purpose:
            E3 = E2/E1 = e(riP, h2(wj)abP) must be equal to C3wi
            
Output :  1 - If the word to be searched wj is found in word dataset wi
          0 - If the word to be searched wj is not found in word dataset wi
          The output also displays the time taken by each function used in scheme

To run the program :

- $g++ BT17CSE043_lab3.cpp -lpbc -lgmp
- $./a.out    


Output:
mugdha@LAPTOP-1ME15EK1:~$ cd Codes
mugdha@LAPTOP-1ME15EK1:~/Codes$ g++ BT17CSE043_lab3.cpp -lgmp -lpbc
mugdha@LAPTOP-1ME15EK1:~/Codes$ ./a.out

=======================================================================
Using type A curve with parameters

type a
q 1833041266268319746412996063865896151291482573579086155002642321460690416863885692883054230261564139077272687636995358800447
h 2508434264301168409859485513796565170462850235152763129633075720126224451008
r 730751167114595186142829002853739519958614802431
exp2 159
exp1 138
sign1 1
sign0 -1

=======================================================================
Starting the Setup function

Order of the G1 group : 730751167114595186142829002853739519958614802431
Element of G1 group g1: [266101345135628824584760455654283614175894608372885838058750009283621322885324126788145360458207847789459763106849376962782, 1771193175290209707085328857332910545929083904956924718842370592916844191873384505344828341991158907587075751485656577958789]
Another element of G1 group g2: [887137607164161712745589855833057592193615276046459654910039078157140152308048681684373546765274100273157002490826642743086, 5439788970427617647955044005015388817026830507785398670721069945374034656097668324898816098898100285711763729200139039611]
Applying symmetric bilinear pairing :g1 X g1, gt= [1465759172745733700535028132584268384466668932519814707496979576237375252920626888698291995276826744417117283741558189010300, 1316454835359775767601579850666550099134096949522870358017555843700408155923416404411669070492760287824761248462391711085861]

Generator selected: [1634033807822672549283353030642303532663637824400876456907463081781933705459670383598959295762150160143871707226867871746743, 1201946078240773351806928177665389448668604276083320824314892447334588370392910772456908446723475448888815900897726964634677]
10010001100101110110011011001101111110001110010110011
After hashing element: [1634033807822672549283353030642303532663637824400876456907463081781933705459670383598959295762150160143871707226867871746743, 1201946078240773351806928177665389448668604276083320824314892447334588370392910772456908446723475448888815900897726964634677] using h1 : G1 -> Z*q
Hashed value : 583440739122789602934466188988710661621146859829
After hashing message: Hello123 using h2 : (0,1)* -> Z*q
Hashed value : 577731834108699792122126708632270096012528529766

=======================================================================
Starting the Key generation function

Data user public key :  [643783267265472959573760223752611509816638337802094025453434299656982850289854847515034655525137154817938460521887917841643, 1537665885852810264034027193279943585698000923923268442167110980340127066101214642868877399691691111077613966462436163662974]

Data sender public key : [389630771098800607927671832031736897427020276026200295916317509667969838395074499408697230090886160795109987116872876973656, 815341943140385245819442815310630922034040497635767204986608629280586755673245148327622816490858725712112252254089169133549]

Data user secret key :  697817307591313279180559918844330277070791756143

Data sender secret key : 134867195192276087251783199580736684550271990845


Enter the size of dataset given by Data Sender
3
1 : Enter the word
hello
2 : Enter the word
joke
3 : Enter the word
kol

Words present in dataset are :
hello
joke
kol

=======================================================================
Starting the SPE_PP function by DS


Random number 577711002694043192998828160941540537506823548897 :

For word: hello

C1w0: [462018440699557194355385762601766693089547190719548947967633175669072604531647711882943758321886015618531498228148066513676, 1520610474067562062120941778411076881803688985077983672549206660720568838113146179456105344529246566267841385335018648910437]

C2w0: [553789404292610478057335618714723955050665208656689281907365220098662477576974099212906696206032886280841785244278397554097, 1619492618987322681149784602217453231731226709881132587653968731964993784646019510714488895107833811875331991190299127026548]

C3w0: [123442136832988769373157895890046884210250369198356644690759618232759514345167671541526697852442136346967571558860268521852, 32263561597883209559753055980276811740618331278958283133285477343604258760099341804493137398539311409660056290430522402518]Random number 25660165949415216619442427841527217755534143480 :

For word: joke

C1w1: [1385026547206496331144815548757884698299870185877864453046011543923396301967610289376941711914701740177755749575307873199679, 1156072127582439616684203331437461236596448522603587553838347344256007255409094975593190040617113431015954296310631471447811]

C2w1: [1262812606455960800869571873541982921249897003564651043014186086326558188216305416267139547066041955815819728566281360550978, 1683520065881511750963932844212121950309136324815576449528349826447325906641550768119434577831815073266364461574216713272510]

C3w1: [1181838764709459924288765615849216228683752517965007256304409234668915270735193078339752661725621233287726370114741989397123, 792589758653831493896823445678155514600583666575118129667495687500602815753343462797492858144025207275855646782559427648287]Random number 351838449317229381932026393699029685770349878097 :

For word: kol

C1w2: [1793915944294398139357163844033961258434997822142298740125055682558029107155297461478000762877179969803246888660125108266044, 649353199199075171070817375232210103488255890190746857980194615628820440698716614101794444014835142252655438667196255476441]

C2w2: [1366947762150241666279916716701078657434181525133206077695931473014762362344389544788761029359444990590081368394172140825430, 315466408551588595917567776968878306338215128999036788426172005772812635979328195119923989466719947729044652705901004103429]

C3w2: [1796307414651459106391154506655415849128957931287508930526202285418748495042431605969941520534185423540569138820385556331904, 218781582173550982311229344118463054316509968266628293251917239046314624335018314980287536962368246938653211695743730845250]

=======================================================================
Starting the trapdoor by DU


Enter the word to be searched
hello

=======================================================================
Starting the Trapdoor by DU

Tw1 : [676310256107920099198550457060476695348685443072050062671355951513124292425989104403584069677724151861078378305210275193204, 1360788034282719767300037317318741587089847772851438593501902428616991067777364172198464233401330788178520991248718111655510]
Tw2 : [1584318991767445618367000397111287639129679294631188049675447119726544471967464001034979281510476682731628896029514305135669, 84165451570143557110309171253780481056915741031984390213640679483324491549774341883846600605864088288643344786971110375719]

=======================================================================
Starting the Test by CSP


For word number : 1

E3 : [123442136832988769373157895890046884210250369198356644690759618232759514345167671541526697852442136346967571558860268521852, 32263561597883209559753055980276811740618331278958283133285477343604258760099341804493137398539311409660056290430522402518]
C3 : [123442136832988769373157895890046884210250369198356644690759618232759514345167671541526697852442136346967571558860268521852, 32263561597883209559753055980276811740618331278958283133285477343604258760099341804493137398539311409660056290430522402518]

Word :hello is found

=======================================================================

Time taken by Setup function: 0.03125
Time taken by Key Generation function: 0
Time taken by SPE_PP function: 0.015625
Time taken by Trapdoor function: 0
Time taken by Test function: 0.015625

=======================================================================
mugdha@LAPTOP-1ME15EK1:~/Codes$
